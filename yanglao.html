<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…»è€æ•™è‚²è´¢åŠ¡è§„åˆ’è®¡ç®—å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans SC', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1); }
        .input-group { transition: all 0.2s; }
        .input-group:focus-within { transform: scale(1.01); }
        .result-card { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
        .highlight-number { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        /* Custom range slider */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            margin-top: -8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #e2e8f0;
            border-radius: 2px;
        }
        
        .tab-active { border-bottom: 3px solid #667eea; color: #667eea; font-weight: 600; }
        .tab-inactive { border-bottom: 3px solid transparent; color: #6b7280; }
        .tab-inactive:hover { color: #374151; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <!-- Header -->
    <div class="gradient-bg text-white py-8 px-4 shadow-lg">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-3xl md:text-4xl font-bold mb-2">ğŸ’° å…»è€æ•™è‚²è´¢åŠ¡è§„åˆ’è®¡ç®—å™¨</h1>
            <p class="text-blue-100 text-lg">å…¨é¢è§„åˆ’æ‚¨çš„é€€ä¼‘ç”Ÿæ´»ä¸å­å¥³æ•™è‚²èµ„é‡‘ï¼Œè€ƒè™‘é€šèƒ€å½±å“ï¼Œç²¾å‡†è®¡ç®—ç¤¾ä¿ç­–ç•¥</p>
        </div>
    </div>

    <div class="max-w-6xl mx-auto px-4 py-8">
        
        <!-- Navigation Tabs -->
        <div class="flex space-x-8 border-b border-gray-200 mb-8 overflow-x-auto">
            <button onclick="switchTab('basic')" id="tab-basic" class="tab-active pb-4 px-2 whitespace-nowrap transition-colors">åŸºç¡€ä¿¡æ¯</button>
            <button onclick="switchTab('pension')" id="tab-pension" class="tab-inactive pb-4 px-2 whitespace-nowrap transition-colors">ç¤¾ä¿å…»è€é‡‘è®¡ç®—</button>
            <button onclick="switchTab('education')" id="tab-education" class="tab-inactive pb-4 px-2 whitespace-nowrap transition-colors">æ•™è‚²é‡‘è§„åˆ’</button>
            <button onclick="switchTab('retirement')" id="tab-retirement" class="tab-inactive pb-4 px-2 whitespace-nowrap transition-colors">å…»è€é‡‘ç¼ºå£</button>
            <button onclick="switchTab('summary')" id="tab-summary" class="tab-inactive pb-4 px-2 whitespace-nowrap transition-colors">ç»¼åˆæŠ¥å‘Š</button>
        </div>

        <!-- Basic Info Tab -->
        <div id="content-basic" class="space-y-6">
            <div class="grid md:grid-cols-2 gap-6">
                <!-- Personal Info -->
                <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <span class="bg-blue-100 text-blue-600 p-2 rounded-lg mr-3">ğŸ‘¤</span>
                        ä¸ªäººä¿¡æ¯
                    </h2>
                    <div class="space-y-4">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">å½“å‰å¹´é¾„</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="currentAge" min="20" max="60" value="30" class="flex-1" oninput="updateValue('currentAge', 'currentAgeVal')">
                                <span class="w-16 text-right font-bold text-blue-600"><span id="currentAgeVal">30</span>å²</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">é¢„è®¡é€€ä¼‘å¹´é¾„</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="retireAge" min="50" max="70" value="60" class="flex-1" oninput="updateValue('retireAge', 'retireAgeVal')">
                                <span class="w-16 text-right font-bold text-blue-600"><span id="retireAgeVal">60</span>å²</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">é¢„æœŸå¯¿å‘½</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="lifeExpectancy" min="70" max="100" value="85" class="flex-1" oninput="updateValue('lifeExpectancy', 'lifeExpectancyVal')">
                                <span class="w-16 text-right font-bold text-blue-600"><span id="lifeExpectancyVal">85</span>å²</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Family Info -->
                <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <span class="bg-green-100 text-green-600 p-2 rounded-lg mr-3">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</span>
                        å®¶åº­çŠ¶å†µ
                    </h2>
                    <div class="space-y-4">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">å­å¥³æ•°é‡</label>
                            <select id="childrenCount" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="toggleChildrenInputs()">
                                <option value="0">0ä¸ª</option>
                                <option value="1" selected>1ä¸ª</option>
                                <option value="2">2ä¸ª</option>
                                <option value="3">3ä¸ªåŠä»¥ä¸Š</option>
                            </select>
                        </div>
                        <div id="child1Age" class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">ç¬¬ä¸€ä¸ªå­©å­å½“å‰å¹´é¾„</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="childAge1" min="0" max="22" value="5" class="flex-1" oninput="updateValue('childAge1', 'childAge1Val')">
                                <span class="w-16 text-right font-bold text-green-600"><span id="childAge1Val">5</span>å²</span>
                            </div>
                        </div>
                        <div id="child2Age" class="input-group hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-1">ç¬¬äºŒä¸ªå­©å­å½“å‰å¹´é¾„</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="childAge2" min="0" max="22" value="3" class="flex-1" oninput="updateValue('childAge2', 'childAge2Val')">
                                <span class="w-16 text-right font-bold text-green-600"><span id="childAge2Val">3</span>å²</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Economic Assumptions -->
                <div class="bg-white rounded-xl shadow-md p-6 card-hover md:col-span-2">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <span class="bg-purple-100 text-purple-600 p-2 rounded-lg mr-3">ğŸ“Š</span>
                        ç»æµå‡è®¾
                    </h2>
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">å¹´é€šèƒ€ç‡ (%)</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="inflationRate" min="0" max="10" step="0.5" value="3" class="flex-1" oninput="updateValue('inflationRate', 'inflationRateVal')">
                                <span class="w-20 text-right font-bold text-purple-600"><span id="inflationRateVal">3</span>%</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">å»ºè®®ï¼š2-4%ï¼ˆä¸­å›½è¿‘å¹´CPIå‡å€¼çº¦2-3%ï¼‰</p>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">æŠ•èµ„æ”¶ç›Šç‡ (%)</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="investReturn" min="0" max="15" step="0.5" value="5" class="flex-1" oninput="updateValue('investReturn', 'investReturnVal')">
                                <span class="w-20 text-right font-bold text-purple-600"><span id="investReturnVal">5</span>%</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">å»ºè®®ï¼šä¿å®ˆ3-4%ï¼Œç¨³å¥5-6%ï¼Œæ¿€è¿›7%+</p>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">å½“å‰å·²æœ‰å‚¨è“„ (ä¸‡å…ƒ)</label>
                            <input type="number" id="currentSavings" value="20" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" onchange="calculateAll()">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pension Tab -->
        <div id="content-pension" class="space-y-6 hidden">
            <div class="grid md:grid-cols-2 gap-6">
                <!-- Social Insurance Config -->
                <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <span class="bg-red-100 text-red-600 p-2 rounded-lg mr-3">ğŸ›ï¸</span>
                        ç¤¾ä¿ç¼´çº³ç­–ç•¥
                    </h2>
                    <div class="space-y-4">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">å‚ä¿åœ°åŒºå¹³å‡å·¥èµ„ (å…ƒ/æœˆ)</label>
                            <input type="number" id="avgSalary" value="8000" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500" onchange="calculatePension()">
                            <p class="text-xs text-gray-500 mt-1">å½“åœ°ç¤¾ä¼šå¹³å‡å·¥èµ„ï¼Œå½±å“ç¼´è´¹åŸºæ•°ä¸Šä¸‹é™</p>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">ç¼´è´¹æ¡£æ¬¡ (%)</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="pensionLevel" min="60" max="300" step="10" value="100" class="flex-1" oninput="updateValue('pensionLevel', 'pensionLevelVal'); calculatePension()">
                                <span class="w-20 text-right font-bold text-red-600"><span id="pensionLevelVal">100</span>%</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">60%-300%ï¼ŒæŒ‰å¹³å‡å·¥èµ„çš„ç™¾åˆ†æ¯”ç¼´çº³</p>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">å·²ç¼´è´¹å¹´é™</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="paidYears" min="0" max="40" value="5" class="flex-1" oninput="updateValue('paidYears', 'paidYearsVal'); calculatePension()">
                                <span class="w-16 text-right font-bold text-red-600"><span id="paidYearsVal">5</span>å¹´</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">è®¡åˆ’ç»§ç»­ç¼´è´¹å¹´é™</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="futureYears" min="0" max="35" value="20" class="flex-1" oninput="updateValue('futureYears', 'futureYearsVal'); calculatePension()">
                                <span class="w-16 text-right font-bold text-red-600"><span id="futureYearsVal">20</span>å¹´</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pension Result -->
                <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <span class="bg-yellow-100 text-yellow-600 p-2 rounded-lg mr-3">ğŸ’µ</span>
                        å…»è€é‡‘é¢„ä¼°
                    </h2>
                    <div class="space-y-4">
                        <div class="result-card rounded-lg p-4">
                            <p class="text-sm text-gray-600 mb-1">é€€ä¼‘æ—¶é¦–æœˆå…»è€é‡‘</p>
                            <p class="text-3xl font-bold highlight-number">Â¥<span id="monthlyPension">0</span></p>
                            <p class="text-xs text-gray-500 mt-1">è€ƒè™‘é€šèƒ€åçš„å®é™…è´­ä¹°åŠ›</p>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-gray-50 rounded-lg p-3">
                                <p class="text-xs text-gray-600">ä¸ªäººè´¦æˆ·å…»è€é‡‘</p>
                                <p class="text-lg font-bold text-gray-800">Â¥<span id="personalPension">0</span></p>
                            </div>
                            <div class="bg-gray-50 rounded-lg p-3">
                                <p class="text-xs text-gray-600">åŸºç¡€å…»è€é‡‘</p>
                                <p class="text-lg font-bold text-gray-800">Â¥<span id="basicPension">0</span></p>
                            </div>
                        </div>
                        <div class="bg-blue-50 rounded-lg p-4 mt-4">
                            <h3 class="font-semibold text-blue-800 mb-2">ç¼´è´¹åˆ†æ</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">æœˆç¼´è´¹é‡‘é¢ï¼š</span>
                                    <span class="font-bold">Â¥<span id="monthlyPay">0</span></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">æ€»ç¼´è´¹å¹´é™ï¼š</span>
                                    <span class="font-bold"><span id="totalYears">0</span>å¹´</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">é¢„è®¡å›æœ¬æ—¶é—´ï¼š</span>
                                    <span class="font-bold text-green-600"><span id="paybackYears">0</span>å¹´</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Pension Strategy Advice -->
            <div class="bg-gradient-to-r from-red-50 to-orange-50 rounded-xl shadow-md p-6 border border-red-100">
                <h3 class="text-lg font-bold text-red-800 mb-3">ğŸ’¡ ç¤¾ä¿ç¼´è´¹ç­–ç•¥å»ºè®®</h3>
                <div id="pensionAdvice" class="space-y-2 text-sm text-gray-700">
                    æ­£åœ¨è®¡ç®—æœ€ä¼˜ç­–ç•¥...
                </div>
            </div>
        </div>

        <!-- Education Tab -->
        <div id="content-education" class="space-y-6 hidden">
            <div class="grid md:grid-cols-2 gap-6">
                <!-- Education Cost Settings -->
                <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <span class="bg-green-100 text-green-600 p-2 rounded-lg mr-3">ğŸ“</span>
                        æ•™è‚²é‡‘éœ€æ±‚
                    </h2>
                    <div class="space-y-4">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">å½“å‰å¹´æ•™è‚²æ”¯å‡º (ä¸‡å…ƒ/å¹´/å­©)</label>
                            <input type="number" id="currentEduCost" value="3" step="0.5" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" onchange="calculateEducation()">
                            <p class="text-xs text-gray-500">åŒ…æ‹¬å­¦è´¹ã€å…´è¶£ç­ã€ç”Ÿæ´»è´¹ç­‰</p>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">å¤§å­¦å¹´è´¹ç”¨é¢„ä¼° (ä¸‡å…ƒ/å¹´)</label>
                            <input type="number" id="collegeCost" value="4" step="0.5" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" onchange="calculateEducation()">
                            <p class="text-xs text-gray-500">å«å­¦è´¹ã€ä½å®¿è´¹ã€ç”Ÿæ´»è´¹ï¼Œè€ƒè™‘é€šèƒ€åçš„æœªæ¥å€¼</p>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">æ˜¯å¦è€ƒè™‘ç•™å­¦</label>
                            <select id="studyAbroad" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" onchange="calculateEducation()">
                                <option value="0">å¦</option>
                                <option value="1">æ˜¯ï¼ˆæœ¬ç§‘é˜¶æ®µï¼‰</option>
                                <option value="2">æ˜¯ï¼ˆç ”ç©¶ç”Ÿé˜¶æ®µï¼‰</option>
                            </select>
                        </div>
                        <div id="abroadCostDiv" class="input-group hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-1">ç•™å­¦å¹´è´¹ç”¨ (ä¸‡å…ƒ/å¹´)</label>
                            <input type="number" id="abroadCost" value="30" step="1" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" onchange="calculateEducation()">
                        </div>
                    </div>
                </div>

                <!-- Education Result -->
                <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <span class="bg-indigo-100 text-indigo-600 p-2 rounded-lg mr-3">ğŸ“š</span>
                        æ•™è‚²é‡‘æ€»éœ€æ±‚
                    </h2>
                    <div class="space-y-4">
                        <div class="result-card rounded-lg p-4">
                            <p class="text-sm text-gray-600 mb-1">æ•™è‚²é‡‘æ€»ç°å€¼ (è€ƒè™‘é€šèƒ€)</p>
                            <p class="text-3xl font-bold highlight-number">Â¥<span id="totalEduCost">0</span>ä¸‡</p>
                            <p class="text-xs text-gray-500 mt-1">ä»ç°åœ¨åˆ°å­©å­å¤§å­¦æ¯•ä¸šæ‰€éœ€å…¨éƒ¨èµ„é‡‘</p>
                        </div>
                        
                        <div class="space-y-3" id="eduBreakdown">
                            <!-- Dynamic content -->
                        </div>

                        <div class="bg-green-50 rounded-lg p-4 mt-4">
                            <h3 class="font-semibold text-green-800 mb-2">èµ„é‡‘å‡†å¤‡å»ºè®®</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">æ¯æœˆéœ€å®šæŠ•ï¼š</span>
                                    <span class="font-bold text-green-700">Â¥<span id="monthlyEduSave">0</span></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">å¹´åŒ–æ”¶ç›Šç‡æŒ‰ï¼š</span>
                                    <span class="font-bold"><span id="eduReturnRate">5</span>%è®¡ç®—</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Education Timeline Chart -->
            <div class="bg-white rounded-xl shadow-md p-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4">æ•™è‚²æ”¯å‡ºæ—¶é—´çº¿</h3>
                <canvas id="eduChart" height="100"></canvas>
            </div>
        </div>

        <!-- Retirement Gap Tab -->
        <div id="content-retirement" class="space-y-6 hidden">
            <div class="grid md:grid-cols-2 gap-6">
                <!-- Retirement Living Cost -->
                <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <span class="bg-purple-100 text-purple-600 p-2 rounded-lg mr-3">ğŸ–ï¸</span>
                        é€€ä¼‘ç”Ÿæ´»éœ€æ±‚
                    </h2>
                    <div class="space-y-4">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">å½“å‰æœˆç”Ÿæ´»è´¹ (å…ƒ)</label>
                            <input type="number" id="currentLivingCost" value="8000" step="500" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" onchange="calculateRetirement()">
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">é€€ä¼‘åç”Ÿæ´»è´¨é‡</label>
                            <select id="retireQuality" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" onchange="calculateRetirement()">
                                <option value="0.7">ç®€æœ´ï¼ˆå½“å‰70%ï¼‰</option>
                                <option value="0.8" selected>èˆ’é€‚ï¼ˆå½“å‰80%ï¼‰</option>
                                <option value="1.0">ç»´æŒç°çŠ¶ï¼ˆ100%ï¼‰</option>
                                <option value="1.2">å“è´¨ç”Ÿæ´»ï¼ˆå½“å‰120%ï¼‰</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-1">é¢„è®¡åŒ»ç–—å¤‡ç”¨é‡‘ (ä¸‡å…ƒ)</label>
                            <input type="number" id="medicalReserve" value="30" step="5" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" onchange="calculateRetirement()">
                        </div>
                    </div>
                </div>

                <!-- Retirement Calculation -->
                <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <span class="bg-orange-100 text-orange-600 p-2 rounded-lg mr-3">ğŸ¯</span>
                        å…»è€é‡‘ç¼ºå£åˆ†æ
                    </h2>
                    <div class="space-y-4">
                        <div class="result-card rounded-lg p-4 border-l-4 border-orange-500">
                            <p class="text-sm text-gray-600 mb-1">é€€ä¼‘æ—¶å…»è€é‡‘æ€»ç¼ºå£</p>
                            <p class="text-3xl font-bold text-orange-600">Â¥<span id="retirementGap">0</span>ä¸‡</p>
                            <p class="text-xs text-gray-500 mt-1">é™¤ç¤¾ä¿å¤–éœ€è‡ªè¡Œå‚¨å¤‡çš„èµ„é‡‘</p>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-gray-50 rounded-lg p-3">
                                <p class="text-xs text-gray-600">é€€ä¼‘æ—¶æ€»éœ€æ±‚</p>
                                <p class="text-lg font-bold text-gray-800">Â¥<span id="totalRetireNeed">0</span>ä¸‡</p>
                            </div>
                            <div class="bg-gray-50 rounded-lg p-3">
                                <p class="text-xs text-gray-600">ç¤¾ä¿å¯è¦†ç›–</p>
                                <p class="text-lg font-bold text-gray-800">Â¥<span id="pensionCover">0</span>ä¸‡</p>
                            </div>
                        </div>

                        <div class="bg-purple-50 rounded-lg p-4">
                            <h3 class="font-semibold text-purple-800 mb-2">è¡¥å……å…»è€å‚¨å¤‡æ–¹æ¡ˆ</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">æ¯æœˆéœ€é¢å¤–å‚¨è“„ï¼š</span>
                                    <span class="font-bold text-purple-700">Â¥<span id="monthlyRetireSave">0</span></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">å å½“å‰æ”¶å…¥æ¯”ä¾‹ï¼š</span>
                                    <span class="font-bold" id="saveRatio">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Retirement Cash Flow Chart -->
            <div class="bg-white rounded-xl shadow-md p-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4">é€€ä¼‘åç°é‡‘æµé¢„æµ‹</h3>
                <canvas id="retireChart" height="100"></canvas>
            </div>
        </div>

        <!-- Summary Tab -->
        <div id="content-summary" class="space-y-6 hidden">
            <!-- Total Overview -->
            <div class="grid md:grid-cols-3 gap-6">
                <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white">
                    <h3 class="text-lg font-semibold mb-2 opacity-90">æ€»èµ„é‡‘éœ€æ±‚ç°å€¼</h3>
                    <p class="text-4xl font-bold mb-1">Â¥<span id="totalNeed">0</span>ä¸‡</p>
                    <p class="text-sm opacity-75">å…»è€ + æ•™è‚²</p>
                </div>
                <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white">
                    <h3 class="text-lg font-semibold mb-2 opacity-90">å·²æœ‰å‚¨è“„</h3>
                    <p class="text-4xl font-bold mb-1">Â¥<span id="summarySavings">0</span>ä¸‡</p>
                    <p class="text-sm opacity-75">å½“å‰å‚¨å¤‡</p>
                </div>
                <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white">
                    <h3 class="text-lg font-semibold mb-2 opacity-90">å‡€ç¼ºå£</h3>
                    <p class="text-4xl font-bold mb-1">Â¥<span id="netGap">0</span>ä¸‡</p>
                    <p class="text-sm opacity-75">éœ€ç§¯ç´¯èµ„é‡‘</p>
                </div>
            </div>

            <!-- Monthly Requirement -->
            <div class="bg-white rounded-xl shadow-md p-8 text-center">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">ç›®æ ‡æœˆæ”¶å…¥è¦æ±‚</h2>
                <p class="text-5xl font-bold highlight-number mb-2">Â¥<span id="requiredIncome">0</span></p>
                <p class="text-gray-600 mb-6">å®¶åº­æœˆæ€»æ”¶å…¥ï¼ˆç¨å‰ä¼°ç®—ï¼‰</p>
                
                <div class="grid md:grid-cols-4 gap-4 max-w-3xl mx-auto text-sm">
                    <div class="bg-gray-50 rounded-lg p-3">
                        <p class="text-gray-600 mb-1">ç”Ÿæ´»æ”¯å‡º</p>
                        <p class="font-bold text-gray-800">Â¥<span id="incomeLiving">0</span></p>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-3">
                        <p class="text-gray-600 mb-1">æ•™è‚²å‚¨è“„</p>
                        <p class="font-bold text-gray-800">Â¥<span id="incomeEdu">0</span></p>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-3">
                        <p class="text-gray-600 mb-1">å…»è€å‚¨è“„</p>
                        <p class="font-bold text-gray-800">Â¥<span id="incomeRetire">0</span></p>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-3">
                        <p class="text-gray-600 mb-1">ç¤¾ä¿ç¼´è´¹</p>
                        <p class="font-bold text-gray-800">Â¥<span id="incomeSocial">0</span></p>
                    </div>
                </div>
            </div>

            <!-- Strategy Recommendations -->
            <div class="bg-white rounded-xl shadow-md p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ“‹ ç»¼åˆç†è´¢ç­–ç•¥å»ºè®®</h3>
                <div id="strategyAdvice" class="space-y-4">
                    <!-- Dynamic content -->
                </div>
            </div>

            <!-- Sensitivity Analysis -->
            <div class="bg-white rounded-xl shadow-md p-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4">å‚æ•°æ•æ„Ÿæ€§åˆ†æ</h3>
                <p class="text-sm text-gray-600 mb-4">è°ƒæ•´ä»¥ä¸‹å‚æ•°æŸ¥çœ‹å¯¹æ€»éœ€æ±‚çš„å½±å“ï¼š</p>
                <div class="space-y-4">
                    <div>
                        <label class="flex justify-between text-sm font-medium text-gray-700 mb-2">
                            <span>é€šèƒ€ç‡</span>
                            <span class="text-blue-600" id="senseInflation">3%</span>
                        </label>
                        <input type="range" min="1" max="8" step="0.5" value="3" class="w-full" oninput="updateSensitivity(this.value, 'inflation')">
                    </div>
                    <div>
                        <label class="flex justify-between text-sm font-medium text-gray-700 mb-2">
                            <span>æŠ•èµ„æ”¶ç›Šç‡</span>
                            <span class="text-blue-600" id="senseReturn">5%</span>
                        </label>
                        <input type="range" min="2" max="10" step="0.5" value="5" class="w-full" oninput="updateSensitivity(this.value, 'return')">
                    </div>
                </div>
                <div class="mt-4 p-4 bg-gray-50 rounded-lg">
                    <p class="text-sm text-gray-700">åœ¨ä»¥ä¸Šå‚æ•°ä¸‹ï¼Œæ€»èµ„é‡‘éœ€æ±‚å˜ä¸ºï¼š<span class="text-2xl font-bold text-blue-600" id="senseTotal">Â¥0ä¸‡</span></p>
                </div>
            </div>
        </div>

        <!-- Action Button -->
        <div class="mt-8 text-center">
            <button onclick="calculateAll()" class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-full text-lg font-bold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all">
                ğŸ”„ é‡æ–°è®¡ç®—æ‰€æœ‰æ–¹æ¡ˆ
            </button>
        </div>
    </div>

    <script>
        // Global variables
        let eduChartInstance = null;
        let retireChartInstance = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            calculateAll();
        });

        function switchTab(tabName) {
            // Hide all contents
            document.querySelectorAll('[id^="content-"]').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('[id^="tab-"]').forEach(el => {
                el.classList.remove('tab-active');
                el.classList.add('tab-inactive');
            });
            
            // Show selected
            document.getElementById(`content-${tabName}`).classList.remove('hidden');
            document.getElementById(`tab-${tabName}`).classList.remove('tab-inactive');
            document.getElementById(`tab-${tabName}`).classList.add('tab-active');
            
            // Trigger calculations if needed
            if (tabName === 'education') calculateEducation();
            if (tabName === 'retirement') calculateRetirement();
            if (tabName === 'summary') calculateSummary();
        }

        function updateValue(inputId, displayId) {
            const val = document.getElementById(inputId).value;
            document.getElementById(displayId).textContent = val;
            calculateAll();
        }

        function toggleChildrenInputs() {
            const count = parseInt(document.getElementById('childrenCount').value);
            document.getElementById('child2Age').classList.toggle('hidden', count < 2);
            calculateAll();
        }

        function calculateAll() {
            calculatePension();
            calculateEducation();
            calculateRetirement();
            calculateSummary();
        }

        // Pension Calculation
        function calculatePension() {
            const avgSalary = parseFloat(document.getElementById('avgSalary').value) || 8000;
            const level = parseInt(document.getElementById('pensionLevel').value) / 100;
            const paidYears = parseInt(document.getElementById('paidYears').value);
            const futureYears = parseInt(document.getElementById('futureYears').value);
            const retireAge = parseInt(document.getElementById('retireAge').value);
            const currentAge = parseInt(document.getElementById('currentAge').value);
            const inflation = parseFloat(document.getElementById('inflationRate').value) / 100;
            
            const totalYears = paidYears + futureYears;
            const monthlyBase = avgSalary * level;
            const monthlyPay = monthlyBase * 0.28; // 28% total (20% pool + 8% personal)
            const personalRate = 0.08;
            const personalMonthly = monthlyBase * personalRate;
            
            // Calculate personal account balance with interest (simplified)
            let personalBalance = personalMonthly * 12 * paidYears;
            // Add future contributions with investment return (using pension fund return rate ~3-4%)
            const pensionReturn = 0.035;
            for (let i = 0; i < futureYears; i++) {
                personalBalance = personalBalance * (1 + pensionReturn) + personalMonthly * 12;
            }
            
            // Monthly pension at retirement
            const months = Math.max(139, (retireAge - 60) * 12 + 139); // simplifiedè®¡å‘æœˆæ•°
            const personalPension = personalBalance / months;
            
            // Basic pension
            const indexedSalary = avgSalary * (1 + level) / 2;
            const basicPension = indexedSalary * totalYears * 0.01;
            
            const totalMonthly = personalPension + basicPension;
            
            // Adjust for inflation to current value (rough estimate)
            const yearsToRetire = retireAge - currentAge;
            const realMonthlyPension = totalMonthly / Math.pow(1 + inflation, yearsToRetire);
            
            // Update display
            document.getElementById('monthlyPension').textContent = Math.round(realMonthlyPension).toLocaleString();
            document.getElementById('personalPension').textContent = Math.round(personalPension).toLocaleString();
            document.getElementById('basicPension').textContent = Math.round(basicPension).toLocaleString();
            document.getElementById('monthlyPay').textContent = Math.round(monthlyPay).toLocaleString();
            document.getElementById('totalYears').textContent = totalYears;
            
            // Payback calculation
            const totalPaid = monthlyPay * 12 * totalYears;
            const paybackMonths = totalPaid / totalMonthly;
            document.getElementById('paybackYears').textContent = (paybackMonths / 12).toFixed(1);
            
            // Advice
            const adviceDiv = document.getElementById('pensionAdvice');
            let advice = '';
            if (totalYears < 15) {
                advice = `<p class="text-red-600 font-semibold">âš ï¸ è­¦å‘Šï¼šå½“å‰ç¼´è´¹å¹´é™ä¸è¶³15å¹´ï¼Œé€€ä¼‘åå°†æ— æ³•é¢†å–å…»è€é‡‘ï¼å»ºè®®è‡³å°‘ç¼´è´¹æ»¡15å¹´ã€‚</p>`;
            } else if (level < 1.0) {
                advice = `<p>â€¢ å½“å‰é€‰æ‹©<span class="font-bold">${(level*100).toFixed(0)}%</span>æ¡£æ¬¡ï¼Œå±äºè¾ƒä½æ°´å¹³ã€‚è‹¥ç»æµå…è®¸ï¼Œå»ºè®®æé«˜è‡³100%-150%æ¡£æ¬¡ï¼Œå¯æ˜¾è‘—æå‡åŸºç¡€å…»è€é‡‘ã€‚</p>
                         <p>â€¢ ç¼´è´¹å¹´é™æ¯”ç¼´è´¹æ¡£æ¬¡æ›´é‡è¦ï¼Œå»ºè®®å°½å¯èƒ½å»¶é•¿ç¼´è´¹æ—¶é—´ã€‚</p>`;
            } else if (level > 2.0) {
                advice = `<p>â€¢ æ‚¨é€‰æ‹©äº†<span class="font-bold">${(level*100).toFixed(0)}%</span>é«˜æ¡£æ¬¡ç¼´è´¹ï¼Œä¸ªäººè´¦æˆ·ç§¯ç´¯ä¸°åšã€‚</p>
                         <p>â€¢ æ³¨æ„ï¼šç¤¾ä¿æœ‰å°é¡¶çº¿ï¼ˆ300%ï¼‰ï¼Œè¶…é¢éƒ¨åˆ†å»ºè®®é€šè¿‡å•†ä¸šå…»è€ä¿é™©æˆ–ä¸ªäººæŠ•èµ„è¡¥å……ã€‚</p>`;
            } else {
                advice = `<p>â€¢ å½“å‰ç¼´è´¹ç­–ç•¥é€‚ä¸­ï¼Œå»ºè®®ä¿æŒè¿ç»­æ€§ï¼Œé¿å…æ–­ç¼´ã€‚</p>
                         <p>â€¢ è‹¥æ”¶å…¥æ³¢åŠ¨ï¼Œå¯æš‚æ—¶é™ä½æ¡£æ¬¡ä½†ä¿æŒå¹´é™ï¼Œé€€ä¼‘å‰5å¹´å¯æé«˜æ¡£æ¬¡æå‡æŒ‡æ•°ã€‚</p>`;
            }
            adviceDiv.innerHTML = advice;
        }

        // Education Calculation
        function calculateEducation() {
            const childrenCount = parseInt(document.getElementById('childrenCount').value);
            const childAge1 = parseInt(document.getElementById('childAge1').value);
            const childAge2 = parseInt(document.getElementById('childAge2').value);
            const currentEduCost = parseFloat(document.getElementById('currentEduCost').value) || 3;
            const collegeCost = parseFloat(document.getElementById('collegeCost').value) || 4;
            const inflation = parseFloat(document.getElementById('inflationRate').value) / 100;
            const investReturn = parseFloat(document.getElementById('investReturn').value) / 100;
            const currentAge = parseInt(document.getElementById('currentAge').value);
            const studyAbroad = parseInt(document.getElementById('studyAbroad').value);
            const abroadCost = parseFloat(document.getElementById('abroadCost').value) || 30;
            
            // Show/hide abroad cost
            document.getElementById('abroadCostDiv').classList.toggle('hidden', studyAbroad === 0);
            
            let totalCost = 0;
            let breakdown = '';
            const years = [];
            const costs = [];
            
            function calcChildCost(age, childNum) {
                let childTotal = 0;
                const yearsToCollege = 18 - age;
                const yearsToGraduate = 22 - age;
                
                // K-12 costs (increasing with inflation)
                for (let i = 0; i < yearsToCollege; i++) {
                    const futureCost = currentEduCost * Math.pow(1 + inflation, i);
                    childTotal += futureCost;
                    const year = new Date().getFullYear() + i;
                    const idx = years.indexOf(year);
                    if (idx >= 0) {
                        costs[idx] += futureCost;
                    } else {
                        years.push(year);
                        costs.push(futureCost);
                    }
                }
                
                // College costs (4 years)
                for (let i = yearsToCollege; i < yearsToGraduate; i++) {
                    let yearCost = collegeCost * Math.pow(1 + inflation, i);
                    if (studyAbroad === 1 && i < yearsToCollege + 4) {
                        yearCost = abroadCost * Math.pow(1 + inflation, i);
                    } else if (studyAbroad === 2 && i >= yearsToCollege + 4 - 2) { // Last 2 years master
                        yearCost = abroadCost * Math.pow(1 + inflation, i);
                    }
                    childTotal += yearCost;
                    const year = new Date().getFullYear() + i;
                    const idx = years.indexOf(year);
                    if (idx >= 0) {
                        costs[idx] += yearCost;
                    } else {
                        years.push(year);
                        costs.push(yearCost);
                    }
                }
                
                return { total: childTotal, yearsToEnd: yearsToGraduate };
            }
            
            const result1 = calcChildCost(childAge1, 1);
            totalCost += result1.total;
            breakdown += `<div class="flex justify-between items-center p-3 bg-green-50 rounded-lg">
                <span class="text-sm text-gray-700">å­©å­1ï¼ˆå½“å‰${childAge1}å²ï¼‰</span>
                <span class="font-bold text-green-700">${result1.total.toFixed(1)}ä¸‡</span>
            </div>`;
            
            if (childrenCount >= 2) {
                const result2 = calcChildCost(childAge2, 2);
                totalCost += result2.total;
                breakdown += `<div class="flex justify-between items-center p-3 bg-green-50 rounded-lg">
                    <span class="text-sm text-gray-700">å­©å­2ï¼ˆå½“å‰${childAge2}å²ï¼‰</span>
                    <span class="font-bold text-green-700">${result2.total.toFixed(1)}ä¸‡</span>
                </div>`;
            }
            
            // Calculate monthly savings needed
            const maxYears = Math.max(result1.yearsToEnd, childrenCount >= 2 ? (22 - childAge2) : 0);
            const monthlySave = calculatePMT(investReturn/12, maxYears * 12, 0, totalCost * 10000) / 10000;
            
            document.getElementById('totalEduCost').textContent = totalCost.toFixed(1);
            document.getElementById('eduBreakdown').innerHTML = breakdown;
            document.getElementById('monthlyEduSave').textContent = (monthlySave * 10000).toFixed(0);
            document.getElementById('eduReturnRate').textContent = (investReturn * 100).toFixed(1);
            
            // Update chart
            updateEduChart(years.sort((a,b) => a-b), costs);
        }

        // Retirement Calculation
        function calculateRetirement() {
            const currentAge = parseInt(document.getElementById('currentAge').value);
            const retireAge = parseInt(document.getElementById('retireAge').value);
            const lifeExpectancy = parseInt(document.getElementById('lifeExpectancy').value);
            const currentLiving = parseFloat(document.getElementById('currentLivingCost').value) || 8000;
            const quality = parseFloat(document.getElementById('retireQuality').value);
            const medical = parseFloat(document.getElementById('medicalReserve').value) || 30;
            const inflation = parseFloat(document.getElementById('inflationRate').value) / 100;
            const investReturn = parseFloat(document.getElementById('investReturn').value) / 100;
            const monthlyPension = parseFloat(document.getElementById('monthlyPension').textContent.replace(/,/g, '')) || 0;
            
            const yearsToRetire = retireAge - currentAge;
            const retireYears = lifeExpectancy - retireAge;
            
            // Future living cost at retirement
            const futureMonthlyLiving = currentLiving * quality * Math.pow(1 + inflation, yearsToRetire);
            const totalLivingNeeded = futureMonthlyLiving * 12 * retireYears;
            
            // Total pension received (simplified, not inflation adjusted for display)
            const totalPension = monthlyPension * 12 * retireYears / 10000; // convert to ä¸‡
            
            // Gap calculation
            const totalNeed = (totalLivingNeeded * Math.pow(1 + inflation, retireYears/2) / 10000) + medical; // rough inflation adjustment
            const gap = Math.max(0, totalNeed - totalPension);
            
            // Monthly savings needed
            const monthlySave = calculatePMT(investReturn/12, yearsToRetire * 12, 0, gap * 10000) / 10000;
            
            document.getElementById('totalRetireNeed').textContent = totalNeed.toFixed(1);
            document.getElementById('pensionCover').textContent = totalPension.toFixed(1);
            document.getElementById('retirementGap').textContent = gap.toFixed(1);
            document.getElementById('monthlyRetireSave').textContent = (monthlySave * 10000).toFixed(0);
            
            // Save ratio estimate (assuming current income is 1.5x living cost)
            const estimatedIncome = currentLiving * 1.5;
            const saveRatio = (monthlySave * 10000 / estimatedIncome * 100).toFixed(1);
            document.getElementById('saveRatio').textContent = saveRatio + '%';
            
            // Update chart
            updateRetireChart(retireAge, lifeExpectancy, monthlyPension, futureMonthlyLiving);
        }

        // Summary Calculation
        function calculateSummary() {
            const currentSavings = parseFloat(document.getElementById('currentSavings').value) || 0;
            const totalEdu = parseFloat(document.getElementById('totalEduCost').textContent) || 0;
            const totalRetire = parseFloat(document.getElementById('totalRetireNeed').textContent) || 0;
            const pensionCover = parseFloat(document.getElementById('pensionCover').textContent) || 0;
            const monthlyEdu = parseFloat(document.getElementById('monthlyEduSave').textContent) || 0;
            const monthlyRetire = parseFloat(document.getElementById('monthlyRetireSave').textContent) || 0;
            const monthlySocial = parseFloat(document.getElementById('monthlyPay').textContent) || 0;
            const currentLiving = parseFloat(document.getElementById('currentLivingCost').value) || 8000;
            
            const totalNeed = totalEdu + totalRetire;
            const netGap = Math.max(0, totalNeed - currentSavings - pensionCover);
            const totalMonthly = currentLiving + monthlyEdu + monthlyRetire + monthlySocial;
            const requiredIncome = totalMonthly * 1.3; // Assuming 30% tax and other deductions
            
            document.getElementById('totalNeed').textContent = totalNeed.toFixed(1);
            document.getElementById('summarySavings').textContent = currentSavings.toFixed(1);
            document.getElementById('netGap').textContent = netGap.toFixed(1);
            document.getElementById('requiredIncome').textContent = Math.round(requiredIncome).toLocaleString();
            
            document.getElementById('incomeLiving').textContent = currentLiving.toLocaleString();
            document.getElementById('incomeEdu').textContent = Math.round(monthlyEdu).toLocaleString();
            document.getElementById('incomeRetire').textContent = Math.round(monthlyRetire).toLocaleString();
            document.getElementById('incomeSocial').textContent = Math.round(monthlySocial).toLocaleString();
            
            // Strategy advice
            const yearsToRetire = parseInt(document.getElementById('retireAge').value) - parseInt(document.getElementById('currentAge').value);
            let strategy = '';
            
            if (netGap <= 0) {
                strategy = `<div class="p-4 bg-green-50 rounded-lg border-l-4 border-green-500">
                    <h4 class="font-bold text-green-800 mb-2">ğŸ‰ è´¢åŠ¡çŠ¶å†µè‰¯å¥½</h4>
                    <p>æ‚¨çš„å½“å‰å‚¨è“„åŠ ä¸Šç¤¾ä¿åŸºæœ¬å¯ä»¥è¦†ç›–æœªæ¥çš„æ•™è‚²å’Œå…»è€éœ€æ±‚ã€‚å»ºè®®ï¼š</p>
                    <ul class="list-disc list-inside mt-2 space-y-1 text-gray-700">
                        <li>ä¿æŒå½“å‰å‚¨è“„ç‡ï¼Œå¯é€‚å½“æé«˜ç”Ÿæ´»è´¨é‡</li>
                        <li>è€ƒè™‘å¢åŠ å•†ä¸šåŒ»ç–—ä¿é™©è¦†ç›–</li>
                        <li>å‰©ä½™èµ„é‡‘å¯é…ç½®éƒ¨åˆ†æƒç›Šç±»èµ„äº§æé«˜æ”¶ç›Š</li>
                    </ul>
                </div>`;
            } else if (yearsToRetire > 20) {
                strategy = `<div class="p-4 bg-blue-50 rounded-lg border-l-4 border-blue-500">
                    <h4 class="font-bold text-blue-800 mb-2">â° é•¿æœŸè§„åˆ’å»ºè®®ï¼ˆ${yearsToRetire}å¹´å‡†å¤‡æœŸï¼‰</h4>
                    <p>æ‚¨æœ‰å……è¶³çš„æ—¶é—´å‡†å¤‡ï¼Œå»ºè®®é‡‡ç”¨"å®šæŠ•+å¤åˆ©"ç­–ç•¥ï¼š</p>
                    <ul class="list-disc list-inside mt-2 space-y-1 text-gray-700">
                        <li>æ¯æœˆå®šæŠ•æŒ‡æ•°åŸºé‡‘${Math.round(monthlyEdu + monthlyRetire)}å…ƒï¼Œåˆ©ç”¨æ—¶é—´å¹³æ»‘å¸‚åœºæ³¢åŠ¨</li>
                        <li>ç¤¾ä¿ç»´æŒ100%-150%æ¡£æ¬¡ï¼Œç¡®ä¿åŸºç¡€ä¿éšœ</li>
                        <li>å»ºç«‹åº”æ€¥åŸºé‡‘ï¼ˆ6ä¸ªæœˆæ”¯å‡ºï¼‰åï¼Œå‰©ä½™èµ„é‡‘æŠ•å…¥æƒç›Šç±»èµ„äº§</li>
                        <li>æ¯5å¹´å¤æ ¸ä¸€æ¬¡è§„åˆ’ï¼Œæ ¹æ®æ”¶å…¥è°ƒæ•´</li>
                    </ul>
                </div>`;
            } else {
                strategy = `<div class="p-4 bg-orange-50 rounded-lg border-l-4 border-orange-500">
                    <h4 class="font-bold text-orange-800 mb-2">âš¡ çŸ­æœŸå†²åˆºå»ºè®®ï¼ˆ${yearsToRetire}å¹´å‡†å¤‡æœŸï¼‰</h4>
                    <p>å‡†å¤‡æ—¶é—´ç´§å¼ ï¼Œéœ€è¦æé«˜å‚¨è“„ç‡å’ŒæŠ•èµ„æ”¶ç›Šï¼š</p>
                    <ul class="list-disc list-inside mt-2 space-y-1 text-gray-700">
                        <li>ç«‹å³å‰Šå‡éå¿…è¦æ”¯å‡ºï¼Œæé«˜å‚¨è“„ç‡è‡³30%ä»¥ä¸Š</li>
                        <li>è€ƒè™‘å»¶é•¿å·¥ä½œå¹´é™è‡³65å²ï¼Œå‡å°‘å…»è€é‡‘é¢†å–å¹´é™</li>
                        <li>ç¤¾ä¿æé«˜è‡³æœ€é«˜æ¡£ï¼ˆ300%ï¼‰ï¼Œæœ€å¤§åŒ–åŸºç¡€å…»è€é‡‘</li>
                        <li>è€ƒè™‘å‰¯ä¸šæˆ–èµ„äº§å˜ç°è¡¥å……èµ„é‡‘ç¼ºå£</li>
                    </ul>
                </div>`;
            }
            
            document.getElementById('strategyAdvice').innerHTML = strategy;
        }

        // Sensitivity Analysis
        function updateSensitivity(value, type) {
            if (type === 'inflation') {
                document.getElementById('senseInflation').textContent = value + '%';
            } else {
                document.getElementById('senseReturn').textContent = value + '%';
            }
            
            // Recalculate with new values
            const inflation = parseFloat(document.getElementById('senseInflation').textContent) / 100;
            const ret = parseFloat(document.getElementById('senseReturn').textContent) / 100;
            
            // Simplified recalculation for display
            const baseEdu = parseFloat(document.getElementById('totalEduCost').textContent) * (1 + (inflation - 0.03) * 5);
            const baseRetire = parseFloat(document.getElementById('totalRetireNeed').textContent) * (1 + (inflation - 0.03) * 10);
            const newTotal = baseEdu + baseRetire;
            
            document.getElementById('senseTotal').textContent = 'Â¥' + newTotal.toFixed(1) + 'ä¸‡';
        }

        // Helper: PMT calculation
        function calculatePMT(rate, nper, pv, fv) {
            if (rate === 0) return -(pv + fv) / nper;
            const pvif = Math.pow(1 + rate, nper);
            let pmt = -rate * (pv * pvif + fv) / (pvif - 1);
            return pmt;
        }

        // Charts
        function updateEduChart(years, costs) {
            const ctx = document.getElementById('eduChart').getContext('2d');
            if (eduChartInstance) eduChartInstance.destroy();
            
            eduChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'å½“å¹´æ•™è‚²æ”¯å‡ºï¼ˆä¸‡å…ƒï¼‰',
                        data: costs.map(c => c.toFixed(2)),
                        backgroundColor: 'rgba(72, 187, 120, 0.6)',
                        borderColor: 'rgba(72, 187, 120, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'é‡‘é¢ï¼ˆä¸‡å…ƒï¼‰' } }
                    }
                }
            });
        }

        function updateRetireChart(retireAge, lifeExpectancy, pension, living) {
            const ctx = document.getElementById('retireChart').getContext('2d');
            if (retireChartInstance) retireChartInstance.destroy();
            
            const years = [];
            const pensionData = [];
            const expenseData = [];
            
            for (let age = retireAge; age <= lifeExpectancy; age++) {
                years.push(age + 'å²');
                pensionData.push(pension);
                expenseData.push(living);
            }
            
            retireChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'æ¯æœˆå…»è€é‡‘',
                        data: pensionData,
                        borderColor: 'rgba(66, 153, 225, 1)',
                        backgroundColor: 'rgba(66, 153, 225, 0.1)',
                        fill: true
                    }, {
                        label: 'æ¯æœˆç”Ÿæ´»æ”¯å‡º',
                        data: expenseData,
                        borderColor: 'rgba(245, 101, 101, 1)',
                        backgroundColor: 'rgba(245, 101, 101, 0.1)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'é‡‘é¢ï¼ˆå…ƒï¼‰' } }
                    }
                }
            });
        }
    </script>
</body>
</html>